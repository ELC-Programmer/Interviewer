<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: InterviewView.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: InterviewView.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * A view where the user conducts a virtual interview.
 * @class
 * @extends StackView
 * @param {InterviewView~Options} options - An object of keyed options for initializing the view.
 */
function InterviewView(options) {
	StackView.call(this, options);
}
extend(StackView, InterviewView);
 
/**
 * @typedef {Object} InterviewView~Options
 * @property {Interviewee} options.interviewee - The interviewee.
 * @property {boolean} [options.canInterrupt=false] - If true, the user can ask a new question or go back in the middle of a response.
 * @property {boolean} [options.canRepeat=false] - If true, the user can ask the same question more than once.
 */
/**
 * @property {InterviewView~Options} options - An object of keyed options for the view.
 */
InterviewView.prototype.options = {
	interviewee: undefined,
	canInterrupt: false,
	canRepeat: false
};

/**
 * @property {string} HTMLSource - The HTML source for this view.
 * @override
 */
InterviewView.prototype.HTMLSource = "&lt;?php StackViewSource() ?>";

/**
 * This function is called when the view is first shown.
 * @override
 */
InterviewView.prototype.onAddToApplication = function()
{
	let scope = this;
	let interviewee = this.options.interviewee;

	let pt = this.DOMObject.find(".question-prototype");

	// Setup the question click handler
	pt.find(".question-button").click(function() {
		let id = $(this).parents(".question").attr("question-id");
		let question = interviewee.questions[id];
		
		if (!interviewee.disabled &amp;&amp; !question.disabled)
		{
			// Disable the question
			if (!scope.options.canRepeat)
			{
				question.disabled = true;
				$(this).toggleClass("question-disabled", question.disabled == true);
			}
			
			// Play the response video
			scope.DOMObject.find(".video").text(interviewee.videoDirectory + question.responseVideo); // TODO, also need to take into account options.canInterrupt !!
			
			// Start the clock, if necessary
			if (!scope.isClockRunning())
			{
				scope.startClock();
			}
		}
	});
	
	// Make empty copies of the prototype
	for (let i in interviewee.questions)
	{
		let question = interviewee.questions[i];
		
		let obj = pt.clone(true)
					.removeClass("question-prototype")
					.addClass("question")
					.attr("question-id", i);
		obj.appendTo(pt.parent());
	}
	
	// Hide the prototype
	pt.hide();
	
	// Back Button
	this.DOMObject.find(".back").click(function() {
		scope.application.pop(interviewee);
	});
}

/**
 * This function is called whenever the view was previously not shown, but now is shown.
 * @override
 */
InterviewView.prototype.onShow = function()
{
	let scope = this;
	let interviewee = this.options.interviewee;
	
	// Header
	this.DOMObject.find(".name").text(interviewee.name);
	this.DOMObject.find(".title").text(interviewee.title);
	
	// Questions
	this.DOMObject.find(".question").each(function() {
		let id = $(this).attr("question-id");
		let question = interviewee.questions[id];
		
		$(this).find(".question-prompt").text(question.prompt);
		
		$(this).toggleClass("question-disabled", question.disabled == true);
	});
	
	// Clock
	this.updateTimeRemaining();
}

/**
 * This function is called whenever the view was previously shown, but now is not anymore.
 */
InterviewView.prototype.onHide = function()
{
	this.stopClock();
}

/**
 * Update the time remaining that is displayed to the user, as well as the time's up display.
 */
InterviewView.prototype.updateTimeRemaining = function()
{
	let interviewee = this.options.interviewee;
	
	this.DOMObject.find(".time").text(formatTime(interviewee.timeRemaining));
	
	this.DOMObject.toggleClass("interviewee-disabled", interviewee.disabled == true);
	this.DOMObject.find(".interviewee-disabled-message").toggle(interviewee.disabled == true);
}

/**
 * @property {(boolean|number)} clockID - The interval ID of the clock running every second, or false if the clock is not running.
 */
InterviewView.prototype.clockID = false;

/**
 * Check if the clock is running.
 * @return {boolean} - Whether or not the clock is currently running.
 */
InterviewView.prototype.isClockRunning = function()
{
	return (this.clockID !== false);
}

/**
 * Start the clock.
 */
InterviewView.prototype.startClock = function()
{
	if (!this.isClockRunning())
	{
		this.clockID = setInterval(this.tickClock, 1000, this);
	}
}

/**
 * Tick the clock forward by one second.
 */
InterviewView.prototype.tickClock = function(scope)
{
	let interviewee = scope.options.interviewee;
	
	if (interviewee.timeRemaining > 0)
	{
		interviewee.timeRemaining -= 1;
	}
	else
	{ // stop the clock
		scope.stopClock();
		interviewee.disabled = true;
	}
	
	scope.updateTimeRemaining();
}

/**
 * Stop the clock.
 */
InterviewView.prototype.stopClock = function()
{
	if (this.isClockRunning())
	{
		clearInterval(this.clockID);
		this.clockID = false;
	}
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="IntervieweeSelectionView.html">IntervieweeSelectionView</a></li><li><a href="InterviewView.html">InterviewView</a></li><li><a href="StackApplication.html">StackApplication</a></li><li><a href="StackView.html">StackView</a></li><li><a href="VideoMessageView.html">VideoMessageView</a></li></ul><h3>Global</h3><ul><li><a href="global.html#extend">extend</a></li><li><a href="global.html#formatTime">formatTime</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Mon May 21 2018 15:40:35 GMT-0700 (Pacific Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
